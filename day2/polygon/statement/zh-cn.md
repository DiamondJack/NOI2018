{{ self.title() }}

{{ s('description') }}

九条可怜是一个喜欢出题的女孩子。

在今年的 World Final 结束以后，可怜特别喜欢计算几何，于是她打算在 NOI 的考场上也出一个计算几何：这是一道只有题目名字和计算几何相关的题目。

首先，可怜给出了一棵 $n(n \geq 2)$ 个节点的有根树 $T$，根节点为 $1$。定义叶子节点为除了根以外所有度数恰好为 $1$ 的节点。下图是一个树 $T$ 的例子，其中叶子节点集合为 $\{3,4,5\}$。

{{ img('1.png', size = 0.3, align = 'middle', inline = False) }}

接着通过这棵树，可怜构造了一个序列 $A$:

- 从根节点开始深度优先遍历整棵树，遍历时按照编号从小到大的顺序来访问孩子，这样可以得到一个树 $T$ 的 DFS 序 $a$。
- 接着按照在 DFS 序中的出现顺序从前往后，可怜把所有叶子节点排成一排得到了一个序列 $A$。

更进一步地，通过序列 $A$，可怜定义了两个叶子节点 $u,v$ 的距离 $d(u,v)$：假设 $u$ 在 $A$ 中是第 $i$ 个元素，$v$ 是第 $j$ 个元素，则 $d(u,v)=\min(|i-j|, |A|-|i-j|)$。其中 $|A|$ 为序列的长度，即 $T$ 的叶子个数。

上面的例子中，序列 $A$ 为 $[3,4,5]$，其中 $d(3,5)=d(3,4)=d(4,5)=1$。

最后，可怜给出了一个参数 $K$，利用这棵有根树 $T$ 和序列$A$，我们可以构造一张 $n$ 个点的无重边的无向图 $G$：两个点 $(u,v)$ 之间右边当且仅当它们满足下列条件中的至少一个：

- 在 $T$ 中存在连接 $u,v$ 的边。
- 在 $T$ 中 $u,v$ 都是叶子节点且 $d(u,v) \leq K$。

当 $K = 1$ 或 $2$ 时，上面的例子得到的图 $G$ 都如下图所示：

{{ img('2.png', size = 0.3, align = 'middle', inline = False) }}

现在可怜想让你来计算一下 $G$ 中不同的哈密尔顿回路数量有多少条，答案可能很大，请对 $998244353$ 取模后输出。

下面是一些补充定义：

- 无向图 $G$ 的一条哈密尔顿回路 $H$ 是 $G$ 中边的一个子集，其中每一个点恰好有两条不同的相邻边在 $H$ 中，且任意两个点都可以通过 $H$ 中的边直接或间接到达。
- 无向图 $G$ 的两条哈密尔顿回路 $H_1,H_2$ 是不同的当且仅当存在一条边 $e$ 使得 $e$ 在 $H_1$ 中且不在 $H_2$ 中。

{{ s('input format') }}

{{ self.input_file() }}

第一行输入两个整数 $n,K$，表示树 $T$ 的点数以及可怜选定的参数 $K$。

第二行输入 $n-1$ 个整数 $f_i(1 \leq f_i \leq i)$，其中 $f_i$ 表示树 $T$ 上存在边 $(f_i,i+1)$。

{{ s('output format') }}

{{ self.output_file() }}

输出一行一个整数，表示哈密尔顿回路数量对 $998244353$ 取模后的结果。

{{ s('sample', 1) }}

{{ self.sample_text() }}


{{ self.title_sample_description() }}

{{ s('sample', 2) }}

{{ self.sample_text() }}

{{ self.title_sample_description() }}

{{ s('sample', 3) }}

{{ self.sample_file() }}

{{ s('subtasks') }}

各测试点的数据规模和性质如下表：

{{ tbl('data') }}

对于所有的数据，保证 $1 \leq f_i \leq i, 2 \leq n \leq 1000$。