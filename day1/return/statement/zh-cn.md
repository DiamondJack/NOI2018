{{ self.title() }}

## {{ _('Background') }}

本题的故事发生在魔力之都，在这里我们将为你介绍关于这座城市的一些必要信息。

魔力之都可以抽象成一个 $n$ 个节点、$m$ 条边的**无向连通图**（节点的编号从 $1$ 至 $n$）。每无向条边有 $3$ 个属性：长度、宽度、海拔。我们分别用 $l,w,a$ 描述这三个属性。它们都是顾名思义的，这里不再赘述。

作为季风气候的代表城市，魔力之都时常有雨水相伴。魔力之都的排水系统非常神奇，每条边的排水系统都在地下相连，然而地下排水系统能容纳水的体积却非常小，达到了可以忽略不计的地步。这也就意味着，**对于所有有积水的边，它们的水位海拔是一致的**。

* 需要特别说明的是，节点的面积是可以忽略不计的，也就是说你可以认为节点不会积水。

在本题中，我们使用单位面积**积水高度**（你同样可以理解为所有道路积水高度按面积加权平均）来描述降雨的程度，这个值我们简称**降水量**。

* **需要特别提醒你的是，请注意这里的积水高度与上面提到的水位海拔之间的区别（你也可以辅助样例来理解）。**

## {{ _('Description') }}

Yazid 是一名来自魔力之都的 OIer，他将踏上归程，回到他温暖的家。

Yazid 的家恰好在魔力之都的 $n$ 号节点。对于接下来 $Q$ 天，每一天 Yazid 都会告诉你他的出发点 $v$ ，以及当天的**降水量** $p$。

每一天，Yazid 在出发点都拥有一辆**车**。这辆车由于一些故障不能经过**有积水**的边。Yazid 可以在任意节点下车，这样接下来他就可以步行经过**有积水**的边。但车会被留在他下车的节点，他只有步行回到该节点才能重新上车。

* 需要特殊说明的是，车在第二天车会被重置。这意味着你即不用担心第二天你会需要去找车（车会在你新的出发点被准备好），又不能利用前一天在某处停放的车（旧的车不能再次被使用）。

Yazid 非常讨厌在雨天步行，因此他希望在完成回家这一目标的同时，最小化他**步行经过的**边的总长度。请你帮助 Yazid 进行计算。

*本题的部分测试点将强制在线，具体细节请见【输入格式】和【子任务】。*

## {{ _('Input Format') }}

{{ self.input_file() }}

第一行 $2$ 个正整数 $n,m$，分别表示节点数、边数。

接下来 $m$ 行，每行 $5$ 个正整数 $u,v,l,w,a$，描述一条连接节点 $u,v$ 的、长度为 $l$、宽度为 $w$、海拔为 $a$ 的边。

接下来一行 $2$ 个非负数 $Q,K,S$，其中 $Q$ 表示总天数，$K\in\left\{0,1\right\}$ 是一个会在下面被用到的系数，$S$ 表示的是可能的最大降水量值。

接下来 $Q$ 行依次描述每天的状况。每行 $2$ 个非负整数 $v_0,p_0$ 描述一天：

* 这一天的出发节点为 $v=\left(v_0+K\times lastans-1\right)\bmod n+1$。

* 这一天的降水量为 $p=\left(p_0+K\times lastans\right)\bmod \left(S+1\right)$。

* 其中 $lastans$ 表示上一天的答案（最小步行总路程）。特别地，我们规定第 $1$ 天时 $lastans=0$。

对于输入中的每一行，如果该行包含多个数，则用单个空格将它们隔开。

## {{ _('Output Format') }}

{{ self.output_file() }}

输出 $Q$ 行每行一个整数，依次表示每天的最小步行总路程。

{% set vars = {} -%}
{%- do vars.__setitem__('sample_id', 1) -%}
{{ self.sample_text() }}

{{ self.title_sample_description() }}

第一天没有降水，Yazid 可以坐车直接回到家中。

第二天连接 $1,2$ 号节点的边有积水，因此 Yazid 从 $2$ 号点出发坐车只能去往 $3$ 号节点，对回家没有帮助。他只能直接步行回到家中。

第三天这条海拔较低的边仍然积水，但另一条边恰好未积水。因此 Yazid 可以坐车先到达 $2$ 号节点，再步行回家。

第四天所有的边都积水了，因此 Yazid 只能纯靠徒步回家。

如下五图依次为：魔力之都的俯视图、第 $1$ 至 $4$ 天每天的降水高度图。

咕 咕 咕 咕 咕

{% do vars.__setitem__('sample_id', 2) -%}
{{ self.sample_text() }}

{{ self.title_sample_description() }}

本组数据强制在线。

第一天的答案是 $0$，因此第二天的 $v=\left( 5+0-1\right)\bmod 5+1=5$，$p=\left(2+0\right)\bmod\left(3+1\right)=2$。

第二天的答案是 $2$，因此第三天的 $v=\left( 2+2-1\right)\bmod 5+1=4$，$p=\left(0+2\right)\bmod\left(3+1\right)=2$。

第三天的答案是 $3$，因此第四天的 $v=\left( 4+3-1\right)\bmod 5+1=2$，$p=\left(0+3\right)\bmod\left(3+1\right)=3$。

{% do vars.__setitem__('sample_id', 3) -%}
{{ self.sample_file() }}

{% do vars.__setitem__('sample_id', 4) -%}
{{ self.sample_file() }}

## {{ _('Subtasks') }}

为了方便你阅读下面的表格，我们对表格中的一些内容作如下说明：

* 图形态：对于表格中该项为“一棵树”或“一条链”的测试点，保证 $m=n-1$。除此之外，这两类测试点分别满足如下限制：

	* 一棵树：保证输入的图是一棵树，即保证边不会构成回路。

	* 一条链：保证所有边满足 $u+1=v$。

* 海拔：对于表格中该项为“两种”或“一种”的测试点，分别满足如下性质：

	* 两种：保证对于所有边，有 $a\in \left\{1,2\right\}$。

	* 一种：保证对于所有边，有 $a=1$。

* 强制在线：对于表格中该项为“是”的测试点，保证 $K=1$；如果该项为“否”，则有 $K=0$。

* 对于所有测试点，如果上述对应项为“不保证”，则对该项内容不作任何保证。

为了优化你的阅读体验，我们把测试点的编号放在了表格的中间，请注意这一点。

{{ tbl('data') }}

所有测试点均保证满足如下限制：

* $n\leq 2\times 10^5$，$m\leq 4\times 10^5$，$Q\leq 3\times 10^5$，$K\in\left\{0,1\right\}$，$1\leq S\leq 10^5$。

* 对于所有边：$1\leq u,v\leq n$，$l\leq 10^4$，$w\leq 10^4$，$a\leq 2\times 10^5$。

* 任意两点之间都直接或间接通过边相连。

* 对于所有询问：$1\leq v_0\leq n$，$p_0\leq S$。

## {{ _('Hint') }}

这里是一个非常温馨的提示。